
<!-- ============================================================== -->
<!-- Grid-->
<!-- ============================================================== -->
 
  <select class="sa_select internal_dentist"  [(ngModel)]="selectedDentist" (ngModelChange)="loadDentist($event)"  [style.display]="'none'">
                     <option value ="all">All Dentist</option>
                    <option *ngFor="let dentist of dentists" [value]="dentist.providerId"> {{dentist.name}}</option>
                </select> 
                <input type="button" id="dentist_initiate" (click) = "initiate_dentist()"  [style.display]="'none'">
                  <input type="button" id="clinic_initiate" (click) = "initiate_clinic()"  [style.display]="'none'">
                <input type="text" id="page_title" value="Clinician Procedures & Referrals" [style.display]="'none'">
<div class="sa_dashboard_inner_content sa_dentist_graphs_area">
   <div class="sa_card topbar-strip">
    <div class="dashboard-top-header" fxLayout="row wrap" fxLayoutGap="0px" fxLayoutGap.md="0" fxLayoutGap.sm="0" fxLayoutGap.xs="0">

      <div fxFlex>
         <div class="sa_tabs_design">
           <span (click)="filterDate('m')" class="filter_m filter sa_filter_span active">This Month</span>
           <span class="filter_lm active filter sa_filter_span" (click)="filterDate('lm')">Last Month</span>
           <span class="filter_q filter sa_filter_span" (click)="filterDate('q')">This Quarter</span>
           <span (click)="filterDate('lq')" class="filter_lq filter sa_filter_span">Last Quarter</span>
           <span (click)="filterDate('cytd')" class="filter_cytd filter sa_filter_span">Calendar Year</span>
           <span (click)="filterDate('fytd')" class="filter_fytd filter sa_filter_span
          ">Financial Year</span>
          <div class="custom_date">
          <input class="filter_custom filter sa_datepicker" id='sa_datepicker' value="Select Date Range" placeholder="Select Date Range" readonly (click)="filterDate('custom')" />
           <ngx-daterangepicker-material class="customRange"  id="customRange" (choosedDate)="choosedDate($event)" [style.display]="'none'" [locale]="{  displayFormat: 'DD-MM-YYYY',firstDay: 1}"></ngx-daterangepicker-material></div>
        </div>
      </div>

     <div class="dh-target">
         <div class="onofftoogle">
          <span class="trend_mode_title">Trend:</span>
              <mat-button-toggle-group #group = "matButtonToggleGroup"  name="fontStyle" class="trendToggle sa_toogle_group2 toggle_switcher" aria-label="Font Style" >
               <mat-button-toggle checked value = "off" class = "target_off target_filter" (click)="toggleFilter('off')">
                  <span>Off</span>
               </mat-button-toggle>
               <mat-button-toggle value = "current" class = "target_current target_filter" (click)="toggleFilter('current')">
                  <span>Monthly</span>
               </mat-button-toggle>
               <mat-button-toggle value = "historic" class = "target_historic target_filter" (click)="toggleFilter('historic')">
                  <span>Annual</span>
               </mat-button-toggle>
            </mat-button-toggle-group>
          </div>
      </div>

  </div>
</div>

<div class=" sa_marketing-area">
<div fxLayout="row wrap" fxLayoutGap="20px" fxLayoutGap.md="0px" fxLayoutGap.sm="0" fxLayoutGap.xs="0">
  <div fxFlex.sm="100" fxFlex.xs="100" fxFlex="100" class="sa_flex_transparent">
    {{startDate}}- {{endDate}}
</div>

  <!-- Column-->
  <div fxFlex="calc(50% - 10px)" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" class="sa_flexbg items_predictor md_mrn" >
    <mat-card class="itemsPredictor">
      <mat-card-content class="sa_matcard_content">
        <mat-card-title class="text-center">
            No. New Patients By Referral
          <div class="sa_box_title_right_buttons">
               <!--  <button mat-icon-button ><i class="fas fa-expand"></i></button>
                <button mat-icon-button [matMenuTriggerFor]="menu"><i class="fas fa-ellipsis-h"></i></button>
                <mat-menu #menu="matMenu">
                    <button mat-menu-item>Save Image</button>
                    <button mat-menu-item>Download PDF</button>
                </mat-menu> -->
            </div>
            <img alt="info-icon" src="../assets/images/info-icon.png">
        </mat-card-title>
        <div class="card-body">
         <div style="height: 326px; position: relative;">
         <div class="sa_back_btn_holder" *ngIf="newPatientsTimeLabelsl2.length > 0"><span (click) ="changeLevel('newPatient')">Back</span></div>
       <canvas *ngIf="newPatientsTimeLabels.length > 0"  #myCanvas2 baseChart [data]="newPatientsTimeData" [labels]="newPatientsTimeLabels" [chartType]="pieChartType" (chartHover)="chartHovered($event)"
          (chartClick)="chartClicked($event,'newPatients')"  [options]="noNewPatientsByReferralChartOptions" [colors]="pieChartColors">
        </canvas>
         <canvas *ngIf="newPatientsTimeLabelsl2.length > 0"  #myCanvas2 baseChart [data]="newPatientsTimeData" [labels]="newPatientsTimeLabelsl2" [chartType]="pieChartType" (chartHover)="chartHovered($event)"
          [options]="noNewPatientsByReferralChartOptions" [colors]="pieChartColors">
        </canvas>

<div *ngIf="newPatientsTimeLabels.length <= 0 && newPatientsTimeLabelsl2.length <= 0 && mkNewPatientsByReferralLoader == false" class="sa_nodata_div">
              <h4>No Data</h4>
              <p></p>
          </div>
      </div>
    </div>
      </mat-card-content>
    </mat-card>
     <div *ngIf="mkNewPatientsByReferralLoader == true" class="loader_container loader_container_middle"><img class="loader_ico" src="../assets/images/720.gif"><div class="loader-text">Calculating...</div></div>
  </div>

   <div fxFlex="calc(50% - 10px)" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" class="sa_flexbg items_predictor md_mrn last" >
    <mat-card class="itemsPredictor">
      <mat-card-content class="sa_matcard_content">
        <mat-card-title class="text-center">
          <div>
          Revenue by Referral
          </div>
          <div class="sa_box_title_right_buttons">
               <!--  <button mat-icon-button ><i class="fas fa-expand"></i></button>
                <button mat-icon-button [matMenuTriggerFor]="menu"><i class="fas fa-ellipsis-h"></i></button>
                <mat-menu #menu="matMenu">
                    <button mat-menu-item>Save Image</button>
                    <button mat-menu-item>Download PDF</button>
                </mat-menu> -->
            </div>
            <img alt="info-icon" src="../assets/images/info-icon.png">
        </mat-card-title>
        <div class="card-body">
        
         <div  style="height: 326px;position: relative;">
           <div class="sa_back_btn_holder" *ngIf="revenueReferralLabelsl2.length > 0"><span (click) ="changeLevel('revenue')">Back</span></div>
       <canvas #revenueRefChart="base-chart" *ngIf="revenueReferralLabels.length > 0" baseChart [data]="revenueReferralData" [labels]="revenueReferralLabels" [chartType]="pieChartType" (chartHover)="chartHovered($event)"
          (chartClick)="chartClicked($event,'revenue')" [options]="pieChartOptions" [colors]="pieChartColors">
        </canvas>
         <canvas #revenueRefChart="base-chart" *ngIf="revenueReferralLabelsl2.length > 0" baseChart [data]="revenueReferralData" [labels]="revenueReferralLabelsl2" [chartType]="pieChartType" (chartHover)="chartHovered($event)"
          [options]="pieChartOptions" [colors]="pieChartColors">
        </canvas>

         <div *ngIf="revenueReferralLabels.length <= 0 && revenueReferralLabelsl2.length <= 0 && mkRevenueByReferralLoader == false" class="sa_nodata_div">
              <h4>No Data</h4>
              <p></p>
          </div>
      
    </div>
    </div>
      </mat-card-content>
    </mat-card>
    <div *ngIf="mkRevenueByReferralLoader == true" class="loader_container loader_container_middle"><img class="loader_ico" src="../assets/images/720.gif"><div class="loader-text">Calculating...</div></div>
  </div>
</div>
  <!-- Column--> 
  <div fxLayout="row wrap" fxLayoutGap="20px" fxLayoutGap.md="0px" fxLayoutGap.sm="0" fxLayoutGap.xs="0">
<div fxFlex="calc(32% - 10px)" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" class="sa_flexbg referral_clinicians">
    <mat-card>
      <mat-card-content class="sa_matcard_content"> 
        <mat-card-title class="text-center">
          <div>
          <span *ngIf="showTrend == false  && trendText" class="referral1Tool referral sa_inc_dec_arrows trend_arrow" matTooltip= "{{trendText}} : {{newPatientsPrevTotal}}"><img class="trend_ico" src="../assets/images/trend_{{newPatientsTooltip}}.png"></span>
          No. New Patients
          </div>
            <div class="sa_box_title_right_buttons">
            </div>  
            <img alt="info-icon" src="../assets/images/info-icon.png">
        </mat-card-title>
        <div class="card-body">
          <div class="chart py-2">
          <div *ngIf="showTrend == false" style="height: 190px">
          <ngx-gauge class="singleRatio" [type]="gaugeType"
           [value]="newPatientsTotal" 
           [thick]="gaugeThick"  
           [foregroundColor]="foregroundColor"
           [backgroundColor]="backgroundColor"
           [cap] ="cap"
           [max] = "maxnewPatientsGoal"
           [size] = "size">
          </ngx-gauge>
      </div>
 <!--         <div *ngIf="showTrend == false && newPatientsTotal<0" class="sa_nodata_div">
              <h4>No Data</h4>
              <p></p>
          </div> -->
       <div *ngIf="showTrend == true" style="height: 300px">
      <canvas #myCanvas baseChart [datasets]="newPatientsChartTrend" [labels]="newPatientsChartTrendLabels" [options]="stackedChartOptions" 
          [chartType]="stackedChartType" (chartHover)="chartHovered($event)" [legend]="false" [colors]="stackedChartColors" (chartClick)="chartClicked($event)">
        </canvas>
      </div>
      
      <div *ngIf="showTrend == true && visitsChartTrendLabels.length <=0" class="sa_nodata_div">
              <h4>No Data</h4>
              <p></p>
          </div>
      </div>
        </div>
        <div class="card-footer">
          <div *ngIf="showTrend == false" fxLayout="row wrap" fxLayoutAlign="center center" class="m-t-40 sa_chart_details_sec pieChartDetails">
                    <div fxFlex.gt-sm="33.33%" fxFlex.gt-xs="33.33%" fxFlex="100" class="text-center">
                        <h3 class="m-0 value-num">{{newPatientsTotal | number:'1.0-0'}}</h3>
                         <span class="value-text" *ngIf="currentText != ''">{{currentText}}</span>
                        <span class="value-text" *ngIf="currentText == ''">Current</span>
                    </div>
                    <div fxFlex.gt-sm="33.33%" fxFlex.gt-xs="33.33%" fxFlex="100" class="text-center" *ngIf="duration != 'custom'">
                        <h3 class="m-0 value-num">{{newPatientsPrevTotal | number:'1.0-0'}}</h3>
                        <span class="value-text" *ngIf="trendText != ''">{{trendText}}</span>
                        <span class="value-text" *ngIf="trendText == ''">Previous</span>
                    </div>
                    <div fxFlex.gt-sm="33.33%" fxFlex.gt-xs="33.33%" fxFlex="100" class="text-center" *ngIf="duration != 'custom'">
                        <h3 class="m-0 value-num">{{newPatientsGoal | number:'1.0-0'}}</h3>
                        <span class="value-text">Goal</span>
                    </div>
                </div>   
                </div>    
      </mat-card-content>
    </mat-card>
    <div *ngIf="fdnewPatientsRatioLoader == true" class="loader_container loader_container_middle"><img class="loader_ico" src="../assets/images/720.gif"><div class="loader-text">Calculating...</div>
    </div>
  </div>
  <div fxFlex="calc(32% - 10px)" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" class="sa_flexbg referral_clinicians">
    <mat-card>
      <mat-card-content class="sa_matcard_content"> 
        <mat-card-title class="text-center">
            <div>
              <span *ngIf="showTrend == false  && trendText" class="referral1Tool referral sa_inc_dec_arrows trend_arrow" matTooltip= "{{trendText}} : ${{newAcqValuePrev}}"><img class="trend_ico" src="../assets/images/trend_{{newPatientsTooltip}}.png"></span>
              Cost of New Patient Acquisition
            </div>
            <div class="CategoriesBtn CategoriesBtnMarketing" *ngIf="showTrend == false"><button class="mat-button-sm mat-green-button" (click)="ngxSmartModalService.getModal('myModal').open()">Set Categories</button></div>
            <img alt="info-icon" src="../assets/images/info-icon.png" *ngIf="showTrend == true">
        </mat-card-title>
        <div class="card-body">
          <div class="chart py-2">
          <div>  
            
          <div  *ngIf="showTrend == false && newAcqValue>0" style="height: 200px">
          <ngx-gauge class="singleRatio" [type]="gaugeType"
           [value]="newAcqValue" 
           [thick]="gaugeThick"  
           [foregroundColor]="foregroundColor"
           [backgroundColor]="backgroundColor"
           [cap] ="cap"
           [prepend] ="gaugePrependText"
           [size] = "size">
            </ngx-gauge>
                       
        </div>
    <div *ngIf="showTrend == false && newAcqValue<=0" class="sa_nodata_div">
              <h4>No Data</h4>
              <p></p>
          </div>
       <div *ngIf="showTrend == true" style="height: 300px">
      <canvas #myCanvas baseChart [datasets]="expenseDataTrend" [labels]="expenseDataTrendLabels" [options]="barChartOptions" 
          [chartType]="stackedChartType" (chartHover)="chartHovered($event)" [legend]="false" [colors]="stackedChartColors" (chartClick)="chartClicked($event)">
        </canvas>
      </div>
        <div *ngIf="showTrend == true && visitsChartTrendLabels.length <=0" class="sa_nodata_div">
              <h4>No Data</h4>
              <p></p>
          </div>
    </div>
      </div>  
        </div>
        <div class="card-footer">
      <div *ngIf="showTrend == false && newAcqValue>0" fxLayout="row wrap" class="pieChartDetails sa_chart_details_sec">
                    <div fxFlex.gt-sm="50%" fxFlex.gt-xs="50%" fxFlex="100" class="text-center">
                        <h3 class="m-0 value-num">$ {{newAcqValue | number:'0.0-0'}}</h3>
                         <span class="value-text" *ngIf="currentText != ''">{{currentText}}</span>
                        <span class="value-text" *ngIf="currentText == ''">Current</span>
                    </div>
                    <div fxFlex.gt-sm="50%" fxFlex.gt-xs="50%" fxFlex="100" class="text-center">
                        <h3 class="m-0 value-num">$ {{newAcqValuePrev | number:'0.0-0'}}</h3>
                        <span class="value-text" *ngIf="trendText != ''">{{trendText}}</span>
                        <span class="value-text" *ngIf="trendText == ''">Previous</span>
                    </div>
                </div>   
                </div>   
      </mat-card-content>
    </mat-card>
  </div>                                                                                                                                                                                
   <div fxFlex="calc(32% - 10px)" fxFlex.md="100" fxFlex.sm="100" fxFlex.xs="100" class="sa_flexbg referral_clinicians last">
    <mat-card>
      <mat-card-content class="sa_matcard_content"> 
        <mat-card-title class="text-center">
          <div>
          <span *ngIf="showTrend == false  && trendText" class="referral_cliniciansrral1Tool referral sa_inc_dec_arrows trend_arrow" matTooltip= "{{trendText}} : {{visitsPrevTotal}}"><img class="trend_ico" src="../assets/images/trend_{{visitsTooltip}}.png"></span>         
          Total Visits
          </div>
            <div class="sa_box_title_right_buttons">
                <!-- <button mat-icon-button ><i class="fas fa-expand"></i></button>
                <button mat-icon-button [matMenuTriggerFor]="menu"><i class="fas fa-ellipsis-h"></i></button>
                <mat-menu #menu="matMenu">
                   <button mat-menu-item>Save Image</button>
                    <button mat-menu-item>Download PDF</button>                                                                                                                
                </mat-menu> -->
            </div>  
            <img alt="info-icon" src="../assets/images/info-icon.png">
        </mat-card-title>      
        <div class="card-body">                                   
           <div class="chart py-2">           
          
          <div *ngIf="showTrend == false" style="height: 190px">
          <ngx-gauge class="singleRatio" [type]="gaugeType"
           [value]="visitsTotal" 
           [thick]="gaugeThick"  
           [foregroundColor]="foregroundColor"
           [backgroundColor]="backgroundColor"
           [cap] ="cap"
           [size] = "size">
          </ngx-gauge>
      </div>

     <!--   <div *ngIf="showTrend == false && visitsTotal<=0 && fdvisitsRatioLoader == false" class="sa_nodata_div">
              <h4>No Data</h4>
              <p></p>
       </div> -->
       <div *ngIf="showTrend == true" style="height: 300px">
      <canvas #myCanvas baseChart [datasets]="visitsChartTrend" [labels]="visitsChartTrendLabels" [options]="stackedChartOptions" 
          [chartType]="stackedChartType" (chartHover)="chartHovered($event)" [legend]="false" [colors]="stackedChartColors" (chartClick)="chartClicked($event)">
        </canvas>
      </div>

      <div *ngIf="showTrend == true && visitsChartTrendLabels.length <=0" class="sa_nodata_div">
              <h4>No Data</h4>
              <p></p>
          </div>
      </div>
        </div>
        <div class="card-footer">
          <div *ngIf="showTrend == false" fxLayout="row wrap" fxLayoutAlign="center center" class="m-t-40 sa_chart_details_sec pieChartDetails">
                    <div fxFlex.gt-sm="50%" fxFlex.gt-xs="50%" fxFlex="100" class="text-center">
                        <h3 class="m-0 value-num">{{visitsTotal | number:'1.0-0'}}</h3>
                        <span class="value-text" *ngIf="currentText != ''">{{currentText}}</span>
                        <span class="value-text" *ngIf="currentText == ''">Current</span>
                    </div>
                    <div fxFlex.gt-sm="50%" fxFlex.gt-xs="50%" fxFlex="100" class="text-center" *ngIf="duration != 'custom'">
                       <h3 class="m-0 value-num">{{visitsPrevTotal | number:'1.0-0'}}</h3>
                       <span class="value-text" *ngIf="trendText != ''">{{trendText}}</span>
                       <span class="value-text" *ngIf="trendText == ''">Previous</span>
                    </div>
                    
                </div> 
                </div>      
      </mat-card-content>
    </mat-card>
    <div *ngIf="fdvisitsRatioLoader == true" class="loader_container loader_container_middle"><img class="loader_ico" src="../assets/images/720.gif"><div class="loader-text">Calculating...</div></div>
    </div>
</div>
</div>
</div>

  <ngx-smart-modal #myModal identifier="myModal">
  <h4 class="mt-0">Select Categories</h4>
   <div fxLayout="row wrap" class="row_sc" fxLayoutGap="20px" fxLayoutGap.md="20px" fxLayoutGap.sm="0" fxLayoutGap.xs="0">
          <div fxFlex="calc(50% - 10px)" fxFlex.md="calc(50% - 10px)" fxFlex.sm="50" fxFlex.xs="50" class="SelectCategories sa_flexbg referral_clinicians">
            <h5 class="mt-0">Selected Categories</h5>
            <ul class="list-categories">
           <li *ngFor="let category of selectedCategories; let i = index">
            <span (click)="remove_category(i)"><i class="fa fa-times"></i></span>
                <span>{{category}}</span></li>
            </ul>
            
          </div>
          <div fxFlex="calc(50% - 10px)" fxFlex.md="calc(50% - 10px)" fxFlex.sm="50" fxFlex.xs="50" class="SelectCategories sa_flexbg referral_clinicians">
            <h5 class="mt-0 other_cat">Other Categories</h5>
            <ul class="list-categories">
              <li *ngFor="let category of categories; let i = index"><span (click)="add_category(i)"><i class="fa fa-plus"></i></span>
                <span>{{category}}</span></li>
            </ul>
            
          </div>
          
        </div>
        <button class="mat-raised-button mat-gray" mat-raised-button (click)="load_chart_acq()">Save</button>
  <button (click)="myModal.close()" class="close_modal" style="display:none">Close</button>
</ngx-smart-modal>
<canvas #myCanvas baseChart [style.display]="'none'" [datasets]="chartData1" [labels]="chartLabels1" [chartType]="pieChartType"></canvas>